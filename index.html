<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Monthly Work Hours</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React + ReactDOM (CDN) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useMemo, useEffect } = React;

      const EMPLOYEES = ["Alice Johnson", "Ben Müller", "Chloe Smith", "Diego García"];
      const PROJECT_PHASES = ["Initiation", "Planning", "Execution", "Closure"];

      function formatDateDDMMYYYY(date) {
        const dd = String(date.getDate()).padStart(2, "0");
        const mm = String(date.getMonth() + 1).padStart(2, "0");
        const yyyy = date.getFullYear();
        return `${dd}-${mm}-${yyyy}`;
      }

      function getDaysInMonth(year, monthIndex) {
        const days = [];
        const first = new Date(year, monthIndex, 1);
        const last = new Date(year, monthIndex + 1, 0);
        for (let d = new Date(first); d <= last; d.setDate(d.getDate() + 1)) {
          days.push(new Date(d));
        }
        return days;
      }

      function TimesheetMonthly() {
        const today = useMemo(() => new Date(), []);
        const [employee, setEmployee] = useState("");
        const defaultMonthValue = useMemo(() => {
          const y = today.getFullYear();
          const m = String(today.getMonth() + 1).padStart(2, "0");
          return `${y}-${m}`;
        }, [today]);
        const [monthValue, setMonthValue] = useState(defaultMonthValue);

        const [year, monthIndex] = useMemo(() => {
          const [yStr, mStr] = monthValue.split("-");
          const y = Number(yStr);
          const mIdx = Number(mStr) - 1;
          return [y, mIdx];
        }, [monthValue]);

        const days = useMemo(() => getDaysInMonth(year, monthIndex), [year, monthIndex]);
        const [entries, setEntries] = useState([]);

        useEffect(() => {
          const next = days.map((date) => ({
            date,
            hours: "",
            description: "",
            phase: "",
            link: "",
          }));
          setEntries(next);
        }, [monthValue]);

        const updateEntry = (idx, key, value) => {
          setEntries((prev) => {
            const clone = [...prev];
            clone[idx] = { ...clone[idx], [key]: value };
            return clone;
          });
        };

        const totalHours = useMemo(() => {
          return entries.reduce((sum, row) => sum + (parseFloat(row.hours) || 0), 0);
        }, [entries]);

        const weekend = (date) => {
          const day = date.getDay();
          return day === 0 || day === 6;
        };

        return (
          <div className="min-h-screen bg-white text-gray-900">
            <div className="max-w-5xl mx-auto p-6">
              <header className="mb-6 flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between">
                <div>
                  <h1 className="text-2xl font-semibold">Monthly Work Hours</h1>
                  <p className="text-sm text-gray-600">
                    Select an employee and month, then enter hours per day.
                  </p>
                </div>

                <div className="flex flex-col sm:flex-row gap-3">
                  <label className="flex items-center gap-3">
                    <span className="text-sm font-medium w-24">Month</span>
                    <input
                      type="month"
                      value={monthValue}
                      onChange={(e) => setMonthValue(e.target.value)}
                      className="border rounded-xl px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-300"
                    />
                  </label>

                  <label className="flex items-center gap-3">
                    <span className="text-sm font-medium w-24">Employee</span>
                    <select
                      value={employee}
                      onChange={(e) => setEmployee(e.target.value)}
                      className="border rounded-xl px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-gray-300"
                    >
                      <option value="" disabled>
                        Select name…
                      </option>
                      {EMPLOYEES.map((name) => (
                        <option key={name} value={name}>
                          {name}
                        </option>
                      ))}
                    </select>
                  </label>
                </div>
              </header>

              {employee ? (
                <div className="rounded-2xl border overflow-hidden shadow-sm">
                  <table className="w-full text-sm">
                    <thead className="bg-gray-50">
                      <tr className="text-left">
                        <th className="px-4 py-3 font-semibold">Date</th>
                        <th className="px-4 py-3 font-semibold w-28">Hours</th>
                        <th className="px-4 py-3 font-semibold">Description</th>
                        <th className="px-4 py-3 font-semibold w-48">Project Phase</th>
                        <th className="px-4 py-3 font-semibold w-64">Link</th>
                      </tr>
                    </thead>
                    <tbody>
                      {entries.map((row, idx) => {
                        const isWeekend = weekend(row.date);
                        return (
                          <tr
                            key={idx}
                            className={
                              (isWeekend ? "bg-gray-100 " : "") +
                              "border-t border-gray-100 hover:bg-gray-50/70"
                            }
                          >
                            <td className="px-4 py-2">{formatDateDDMMYYYY(row.date)}</td>
                            <td className="px-4 py-2">
                              <input
                                type="number"
                                min="0"
                                step="0.25"
                                value={row.hours}
                                onChange={(e) => updateEntry(idx, "hours", e.target.value)}
                                className="w-24 border rounded-lg px-2 py-1 focus:outline-none focus:ring-2 focus:ring-gray-300"
                              />
                            </td>
                            <td className="px-4 py-2">
                              <input
                                type="text"
                                value={row.description}
                                onChange={(e) =>
                                  updateEntry(idx, "description", e.target.value)
                                }
                                className="w-full border rounded-lg px-3 py-1 focus:outline-none focus:ring-2 focus:ring-gray-300"
                              />
                            </td>
                            <td className="px-4 py-2">
                              <select
                                value={row.phase}
                                onChange={(e) => updateEntry(idx, "phase", e.target.value)}
                                className="w-full border rounded-lg px-3 py-1 bg-white focus:outline-none focus:ring-2 focus:ring-gray-300"
                              >
                                <option value="" disabled>
                                  Select phase…
                                </option>
                                {PROJECT_PHASES.map((p) => (
                                  <option key={p} value={p}>
                                    {p}
                                  </option>
                                ))}
                              </select>
                            </td>
                            <td className="px-4 py-2">
                              <input
                                type="url"
                                value={row.link}
                                onChange={(e) => updateEntry(idx, "link", e.target.value)}
                                className="w-full border rounded-lg px-3 py-1 focus:outline-none focus:ring-2 focus:ring-gray-300"
                                placeholder="https://…"
                              />
                            </td>
                          </tr>
                        );
                      })}
                    </tbody>
                    <tfoot>
                      <tr className="bg-gray-50 border-t">
                        <td className="px-4 py-3 font-medium">Total</td>
                        <td className="px-4 py-3 font-semibold">
                          {totalHours.toFixed(2)}
                        </td>
                        <td colSpan="3" className="px-4 py-3 text-gray-500 text-xs">
                          Weekend days are highlighted in grey.
                        </td>
                      </tr>
                    </tfoot>
                  </table>
                </div>
              ) : (
                <div className="mt-10 text-gray-600 text-sm">
                  Choose an employee to display the monthly table.
                </div>
              )}
            </div>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<TimesheetMonthly />);
    </script>
  </body>
</html>

